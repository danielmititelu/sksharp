namespace SkSharp.Tests;

public class TokenUtilsTests
{
    [Test]
    public void RegistrationTokenHeader()
    {
        var expectedRegistrationToken = "registrationToken=U2lnbmF0dXJlOjI6Mjg6QVFRQUFBRFVRUTVQYWF4bm5aa2JGL2w3TUkzRztWZXJzaW9uOjY6MToxO0lzc3VlVGltZTo0OjE5OjUyNDk5MTQ5MjAzOTc4NzMzNjk7RXAuSWRUeXBlOjc6MTo4O0VwLklkOjI6MjY6bGl2ZTouY2lkLjZmMzQwYjA0NWRmOTNiMjE7RXAuRXBpZDo1OjM2OjAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMDtFcC5Mb2dpblRpbWU6NzoxOjA7RXAuQXV0aFRpbWU6NDoxOTo1MjQ5OTE0OTIwMzk3MjQ4MzU4O0VwLkF1dGhUeXBlOjc6MjoxNTtFcC5FeHBUaW1lOjQ6MTk6NTI0OTkxNTc4Mzk3NzM4NzkwNDtFcC5Ta3lwZVRva2VuOjI6Njg4OmV5SmhiR2NpT2lKU1V6STFOaUlzSW10cFpDSTZJalZGT0RRNE1qRTBRemMzTURjelFVVTFRekpDUkVVMVEwTkVOVFEwT0RsRVJFWXlRelJET0RRaUxDSjROWFFpT2lKWWIxTkRSazFrZDJNMk5XTkxPVFZqZWxaU1NXNWtPSE5VU1ZFaUxDSjBlWEFpT2lKS1YxUWlmUS5leUpwWVhRaU9qRTJPRGN5T1RNek5UWXNJbVY0Y0NJNk1UWTROek0zT1RjMU5Td2ljMnQ1Y0dWcFpDSTZJbXhwZG1VNkxtTnBaQzQyWmpNME1HSXdORFZrWmprellqSXhJaXdpYzJOd0lqbzVOVFlzSW1OemFTSTZJakUyT0RjeU9UTXpOVFVpTENKamFXUWlPaUkyWmpNME1HSXdORFZrWmprellqSXhJaXdpWVdGMElqb3hOamczTWprek16VTFmUS5aZ1JEci0wYXpqUVFWYUxCLTY1cDhncG1jQTIyNmZJSm9NQzhPWmJHZzJzcVQ5LUV6YzJlU1RUY2ViODJvbU9Yc1RwUHpLNjd5ZFV4OGpXVHVlUGJwbTRrOHAyODdkejVLTXdaVGRjR1pvTmhyckRYTzd1cmxkNXpSR2lwQldtOFpUQXhCdndVTkdGNlA2T2pWaTM3SldpOHU0NnNxZGlHN0VfeHpRcHBUZmticDl2b0xWVmxrNjdMNEZpSXlzZ0UwbmM3dVRlMXE0MG00a3NPU05WOVdYSTBKN01ZQnYtM2RUSVhLTmFzbHRrX0pCdmhzajEzRWhGZHpnM3NfNFBLTWM1YmJ4cDdWeDJxNGN5bW85UnRMcjNkTHNYT05rUmEtdm1mSGhJaUZRQUs2YlZ4S0tEZjdoMWZtUWI5YTBYajRfWUdySkJHMVRuXzczTGwySGJNMkE7VXNyLk5ldE1hc2s6MTE6MToyO1Vzci5YZnJDbnQ6NjoxOjA7VXNyLlJkcmN0RmxnOjI6MDo7VXNyLkV4cElkOjk6MTowO1Vzci5FeHBJZExhc3RMb2c6NDoxOjA7VXNlci5BdGhDdHh0OjI6NDQ0OkNsTnJlWEJsVkc5clpXNGFiR2wyWlRvdVkybGtMalptTXpRd1lqQTBOV1JtT1ROaU1qRUJBMVZwWXhReEx6RXZNREF3TVNBeE1qb3dNRG93TUNCQlRReE9iM1JUY0dWamFXWnBaV1FoTy9sZEJBczBid0FBQUFBQUFFQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQWFiR2wyWlRvdVkybGtMalptTXpRd1lqQTBOV1JtT1ROaU1qRUFBQUFBQUFBQUFBQUhUbTlUWTI5eVpRQUFBQUFFQUFBQUFBQUFBQUFBQUFBaE8vbGRCQXMwYndBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQVJwc2FYWmxPaTVqYVdRdU5tWXpOREJpTURRMVpHWTVNMkl5TVFBQUFBQUFxdzJTWkFjQUFBQUlTV1JsYm5ScGRIa09TV1JsYm5ScGRIbFZjR1JoZEdVSVEyOXVkR0ZqZEhNT1EyOXVkR0ZqZEhOVmNHUmhkR1VJUTI5dGJXVnlZMlVOUTI5dGJYVnVhV05oZEdsdmJoVkRiMjF0ZFc1cFkyRjBhVzl1VW1WaFpFOXViSGtBQUE9PTs=";
        var expectedExpires = 1687192941;
        var expectedEndpointId = "{df99ad7b-4349-4992-8963-df1ab2dbbd55}";
        var registrationtokenHeader = $"{expectedRegistrationToken}; expires={expectedExpires}; endpointId={expectedEndpointId}";
        var (registrationToken, expires, e) = TokenUtils.ParseRegistrationTokenHeader(registrationtokenHeader);
        Assert.Multiple(() =>
        {
            Assert.That(registrationToken, Is.EqualTo(expectedRegistrationToken));
            Assert.That(expires, Is.EqualTo(expectedExpires));
            Assert.That(e, Is.EqualTo(expectedEndpointId));
        });
    }
}